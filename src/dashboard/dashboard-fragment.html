<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../layouts/fragment-layout.html">
<link rel="import" href="../dashboard/dashboard-leaderboard.html">
<link rel="import" href="../dashboard/dashboard-open-matches.html">
<link rel="import" href="../dashboard/dashboard-latest-matches.html">
<link rel="import" href="../dashboard/dashboard-stats.html">
<link rel="import" href="../styles/app-styles.html">
<link rel="import" href="../common/corpopong-icons.html">

<dom-module id="dashboard-fragment">
  <template>
    <style include="app-styles"></style>
    <style>
    dashboard-leaderboard, dashboard-open-matches, dashboard-stats {
      display: block;
      margin-bottom: 1rem;
    }

    .responsive {
      @apply --layout-horizontal;
      @apply --layout-wrap;
      @apply --layout-justified;
    }

    .responsive > * {
      @apply --layout-flex;
      -ms-flex-preferred-size: 100%;
          flex-basis: 100%;
    }

    .fab-morpher {
      position: fixed;
      width:56px;
      height: 56px;
      right:1rem;
      bottom:1rem;
      background-color: var(--accent-color);
      transform-origin: 50% 50%;
      border-radius: 50%;
      z-index: 2;
      opacity: 0;
      pointer-events: none;
    }
    .fab-morpher{
      transition: right 200ms ease-out, bottom 200ms ease-in, border-radius 200ms ease-in, transform 200ms ease-in 100ms, background-color 200ms ease-in;
    }
    .fab-morpher.animating {
      right: calc(50% - 28px);
      bottom: calc(50% - 28px);
      border-radius: 0;
      transform: scale(40, 40);
      background-color: var(--primary-background-color);
      opacity: 1;
    }

    @media (min-width: 1100px) {
        .responsive > * {
            -ms-flex-preferred-size: 45%;
                flex-basis: 45%;
        }
        dashboard-leaderboard {
          margin-right: 1rem;
        }
    }

    </style>
    <fragment-layout title="CorpoPong" org="[[org]]" fullbleed>

      <div class="responsive">
        <dashboard-leaderboard org="[[org]]"></dashboard-leaderboard>
        <div>
          <dashboard-stats org="[[org]]"></dashboard-stats>
          <dashboard-open-matches user-uid="[[userUid]]" org="[[org]]"></dashboard-open-matches>
          <dashboard-latest-matches org="[[org]]"></dashboard-latest-matches>
        </div>
      </div>

      <paper-fab  id="fab" class="fixed-fab" icon="corpopong:paddles" on-click="_onCreateClick"></paper-fab>
    </fragment-layout>
    <div id="morpher" class="fab-morpher"></div>

  </template>
  <script>
    class DashboardFragment extends Polymer.Element {
      static get is () { return 'dashboard-fragment' }
      static get properties () {
        return {
          org: String,
          userUid: String
        }
      }
      _onCreateClick () {
        this.$.fab.style.display = 'none'
        this.$.morpher.classList.add('animating')

        setTimeout(() => {
          this.dispatchEvent(new CustomEvent('create-match-click'))
          this.$.morpher.style = null
          this.$.fab.style = null
          this.$.morpher.classList.remove('animating')
        }, 300)
      }
    }

    window.customElements.define(DashboardFragment.is, DashboardFragment)
  </script>
</dom-module>
