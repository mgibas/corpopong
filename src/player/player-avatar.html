<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/progress-spinner/progress-spinner.html">
<link rel="import" href="../styles/app-styles.html">

<dom-module id="player-avatar">
  <template>
    <style include="app-styles"></style>
    <style>
    :host {
      display: block;
      position:relative;
    }
    :host,
    iron-image,
    .circle-frame {
      height: 42px;
      width: 42px;
    }
    :host([big]),
    :host([big]) iron-image,
    :host([big]) .circle-frame {
      height: 128px;
      width: 128px;
    }
    .circle-frame, iron-image {
      z-index: 0;
      border-radius: 50%;
      overflow: hidden;
      @apply --shadow-elevation-3dp;
    }
    progress-spinner {
      position: absolute;
      left: -3px;
      top: -3px;
    }
    </style>
    <div class="circle-frame">
      <iron-image
        src="[[src]]"
        sizing="cover"
        fade>
      </iron-image>
    </div>
    <template is="dom-if" if="[[spinner]]">
      <progress-spinner size="134" bar-size="6" active="[[_spinnerActive]]"></progress-spinner>
    </template>
  </template>
  <script>
    class PlayerAvatar extends Polymer.Element {
      static get is () { return 'player-avatar' }
      static get properties () {
        return {
          src: String,
          big: {
            type: Boolean,
            reflectToAttribute: true
          },
          spinner: Boolean,
          _spinnerActive: {
            type: Boolean,
            value: true,
            computed: '_computeSpinnerActive(src)'
          }
        }
      }
      _computeSpinnerActive (src) {
        return !src
      }
    }

    window.customElements.define(PlayerAvatar.is, PlayerAvatar)
  </script>
</dom-module>
